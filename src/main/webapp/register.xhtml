<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      lang="es" xml:lang="es">
<h:head>
    <title>Registro</title>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <h:outputStylesheet library="css" name="font-awesome.min.css" />
    <style type="text/css">
        /* ... (todos los estilos CSS se mantienen igual) ... */
    </style>
</h:head>

<h:body>
    <div class="auth-container">
        <div class="auth-card">
            <h1 class="auth-title">Crear Cuenta en KawsayFit</h1>

            <h:form id="registerForm" styleClass="auth-form">
                <h:messages globalOnly="true" styleClass="error-message" />

                <div class="form-group">
                    <h:outputLabel for="name" value="Nombre Completo" />
                    <h:inputText id="name" value="#{registroController.usuario.nombreCompleto}"
                                 required="true" requiredMessage="El nombre es obligatorio" />
                    <h:message for="name" styleClass="error-message" />
                </div>

                <div class="form-group">
                    <h:outputLabel for="email" value="Correo Electrónico" />
                    <h:inputText id="email" value="#{registroController.usuario.email}"
                                 required="true" requiredMessage="El correo es obligatorio"
                                 validatorMessage="Correo electrónico inválido">
                        <f:validateRegex pattern="^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$" />
                    </h:inputText>
                    <h:message for="email" styleClass="error-message" />
                </div>

                <div class="form-group password-group">
                    <h:outputLabel for="password" value="Contraseña" />
                    <div class="password-input-wrapper">
                        <h:inputSecret id="password" value="#{registroController.usuario.password}"
                                       required="true" requiredMessage="La contraseña es obligatoria"
                                       styleClass="password-input" />
                        <span class="icon-eye toggle-password" data-target="registerForm:password">
                            <i class="fas fa-eye"></i>
                        </span>
                    </div>
                    <h:message for="password" styleClass="error-message" />
                </div>

                <div class="form-group password-group">
                    <h:outputLabel for="confirmPassword" value="Confirmar Contraseña" />
                    <div class="password-input-wrapper">
                        <h:inputSecret id="confirmPassword" value="#{registroController.confirmPassword}"
                                       required="true" requiredMessage="Debes confirmar la contraseña"
                                       styleClass="password-input" />
                        <span class="icon-eye toggle-password" data-target="registerForm:confirmPassword">
                            <i class="fas fa-eye"></i>
                        </span>
                    </div>
                    <h:message for="confirmPassword" styleClass="error-message" />
                </div>

                <h:commandButton value="Registrarse" action="#{registroController.registrarUsuario}"
                                 styleClass="auth-button" />
            </h:form>

            <div class="auth-footer">
                <p>¿Ya tienes una cuenta? <h:link value="Inicia sesión aquí" outcome="iniciar-sesion" /></p>
            </div>
        </div>
    </div>

    <h:outputScript name="js/register.js" target="body" />
    <script type="text/javascript">
        // <![CDATA[
        document.addEventListener('DOMContentLoaded', function() {
            var toggleIcons = document.querySelectorAll('.toggle-password');
            for (var i = 0; i < toggleIcons.length; i++) {
                toggleIcons[i].addEventListener('click', function () {
                    var targetId = this.getAttribute('data-target');
                    var input = document.getElementById(targetId);
                    if (input) {
                        var isPassword = input.type === 'password';
                        input.type = isPassword ? 'text' : 'password';

                        var eyeIcon = this.getElementsByTagName('i')[0];
                        if (eyeIcon.classList.contains('fa-eye')) {
                            eyeIcon.classList.remove('fa-eye');
                            eyeIcon.classList.add('fa-eye-slash');
                        } else {
                            eyeIcon.classList.remove('fa-eye-slash');
                            eyeIcon.classList.add('fa-eye');
                        }
                    }
                }, false);
            }
        });
        // ]]>
    </script>
</h:body>
</html>